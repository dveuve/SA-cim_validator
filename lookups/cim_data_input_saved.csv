datamodel,search
"UBA_Firewall","| inputlookup ES_Opsec.csv | search vendor_product=""VPN*"" | eval bytes=0, bytes_in=0, bytes_out=0, dest_ip=coalesce(dest_ip, dest), dest_port=coalesce(dest_port, service), protocol=proto, vendor_action=action, src_translated_port = xlatesport,  src_translated_ip = xlatesrc, dest_translated_port = xlatedport,  dest_translated_ip = xlatedst"
"UBA_DHCP","| inputlookup DHCP.csv  | rex field=_raw ""(?<signature>\w*) to (?<dest_ip>[\d\.]{7,}) \((?<dest_mac>[\d\w:]{11,})"" | eval lease_duration=8*3600, tag=""network,session"" | search signature=DHCPACK"
"UBA_DNS","| inputlookup DNS.csv | eval query=Question_Name, record_type=Question_Type, query_type=OpCode, answer="""", message_type=""Query"", tag=""network,resolution,dns""| rex mode=sed field=query ""s/\(\d*\)/./g"" | eval src_ip=if(cidrmatch(""10.0.0.0/8"", Remote_IP) OR cidrmatch(""10.0.0.0/8"", Remote_IP) OR cidrmatch(""192.168.0.0/16"", Remote_IP) OR cidrmatch(""172.16.0.0/12"", Remote_IP), Remote_IP, """"), dest_ip=if(src_ip="""", Remote_IP, """")"
"UBA_Identity","| inputlookup LDAPSearch.csv | search  userAccountControl!=*ACCOUNTDISABLE* userAccountControl=*NORMAL_ACCOUNT* sAMAccountName!=""*SVC*$"" dn!=""*CN=Computers*"" dn!=""*OU=Desktops*"" dn!=""*OU=Servers*""  dn!=""*OU=Workstations*""   dn!=""*OU=Computers*""   | rename userAccountControl as UAC employeeID as employeeid | eval employeeid=coalesce(employeeid,sAMAccountName), hrAccountType=case(match(sAMAccountName, ""^[!_]?[sS][vV][cC]""), ""Service"", match(sAMAccountName, ""_?svc_?(account|usr|user)""), ""Service"", match(sAMAccountName, ""^_.*$""), ""Admin"", match(sAMAccountName, ""^[rR][aA]_.*$""), ""UNKNOWN-ra"", match(sAMAccountName, ""^FR\..*$""), ""UNKNOWN-FR"", match(sAMAccountName, ""^!.*$""), ""UNKNOWN-!"", match(sAMAccountName, ""^[aA][tT]\..*$""), ""UNKNOWN-AT"", match(sAMAccountName, ""^[cC][wW][rR]\..*$""), ""UNKNOWN-CWR"",match(sAMAccountName, ""^s\..*$""), ""UNKNOWN-s"", match(sAMAccountName, ""^EU\..*$""), ""UNKNOWN-EU"", match(sAMAccountName, ""^test\d?\..*$""), ""Test"", 1=1, ""Normal"") | fields - dn  | rex field=manager ""CN=(?<manager>.*?),OU="" | rex mode=sed field=manager ""s/\\\//g"""
